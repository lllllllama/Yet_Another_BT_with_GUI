# Yet-Another-BT GTKå›¾å½¢ç•Œé¢ç‰ˆæœ¬ä½¿ç”¨è¯´æ˜

## ğŸ“– ç®€ä»‹

æœ¬é¡¹ç›®ç°åœ¨æä¾›ä¸¤ä¸ªç‰ˆæœ¬çš„GUIï¼š

| ç‰ˆæœ¬ | ç•Œé¢ç±»å‹ | å¯æ‰§è¡Œæ–‡ä»¶ | ä¾èµ–åº“ | é€‚ç”¨åœºæ™¯ |
|------|---------|-----------|--------|---------|
| **ncursesç‰ˆ** | ç»ˆç«¯ç•Œé¢ | `ttorrent` | libncurses | SSHè¿œç¨‹ã€æœåŠ¡å™¨ç¯å¢ƒ |
| **GTKç‰ˆ** | å›¾å½¢åŒ–çª—å£ | `ttorrent-gtk` | GTK+3 | æ¡Œé¢ç¯å¢ƒ |

---

## ğŸ¨ GTKå›¾å½¢ç•Œé¢ç‰¹æ€§

- âœ… **çœŸæ­£çš„çª—å£ç•Œé¢**ï¼Œä¸æ˜¯ç»ˆç«¯æ¨¡æ‹Ÿ
- âœ… **å®æ—¶è¿›åº¦æ¡**ï¼Œç›´è§‚æ˜¾ç¤ºä¸‹è½½è¿›åº¦
- âœ… **ç»Ÿè®¡é¢æ¿**ï¼Œæ˜¾ç¤ºé€Ÿåº¦ã€peeræ•°é‡ç­‰
- âœ… **æ—¥å¿—çª—å£**ï¼Œå®æ—¶æ˜¾ç¤ºä¸‹è½½æ—¥å¿—
- âœ… **å¤šçº¿ç¨‹æ¶æ„**ï¼ŒGUIå’Œä¸‹è½½é€»è¾‘åˆ†ç¦»
- âœ… **çº¿ç¨‹å®‰å…¨**ï¼Œä½¿ç”¨äº’æ–¥é”ä¿æŠ¤æ•°æ®æ›´æ–°

---

## ğŸ”§ ç¼–è¯‘å®‰è£…

### 1. å®‰è£…ä¾èµ–

#### Ubuntu/Debian
```bash
sudo apt update
sudo apt install build-essential
sudo apt install libssl-dev
sudo apt install libgtk-3-dev
sudo apt install pkg-config
```

#### Fedora/RHEL/CentOS
```bash
sudo dnf groupinstall "Development Tools"
sudo dnf install openssl-devel
sudo dnf install gtk3-devel
sudo dnf install pkg-config
```

#### macOS
```bash
brew install gtk+3
brew install openssl
brew install pkg-config
```

### 2. éªŒè¯GTKå®‰è£…

```bash
pkg-config --modversion gtk+-3.0
```

åº”è¯¥æ˜¾ç¤ºç±»ä¼¼ï¼š`3.24.xx`

### 3. ç¼–è¯‘GTKç‰ˆæœ¬

```bash
cd /path/to/yet-another-bt

# åªç¼–è¯‘GTKç‰ˆæœ¬
make -f Makefile gtk

# æˆ–ç¼–è¯‘ä¸¤ä¸ªç‰ˆæœ¬
make -f Makefile all
```

ç¼–è¯‘æˆåŠŸåä¼šç”Ÿæˆï¼š
- `ttorrent-gtk` - GTKå›¾å½¢ç•Œé¢ç‰ˆæœ¬ â­
- `ttorrent` - ncursesç»ˆç«¯ç‰ˆæœ¬

---

## ğŸš€ è¿è¡Œ

### GTKå›¾å½¢ç•Œé¢ç‰ˆæœ¬

```bash
./ttorrent-gtk your-file.torrent
```

**ç•Œé¢é¢„è§ˆ**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        BitTorrent ä¸‹è½½è¿›åº¦                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¿›åº¦: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 45.3%               â”‚
â”‚ Pieces: 453 / 1000                                  â”‚
â”‚                                                     â”‚
â”‚ ä¸‹è½½é€Ÿåº¦: 2.34 MB/s    ä¸Šä¼ é€Ÿåº¦: 512 KB/s           â”‚
â”‚ å·²ä¸‹è½½: 453 MB         è¿æ¥çš„Peers: 15              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä¸‹è½½æ—¥å¿—:                                            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [18:30:15] GUIå·²åˆå§‹åŒ–                          â”‚ â”‚
â”‚ â”‚ [18:30:15] å¼€å§‹BitTorrentä¸‹è½½...                â”‚ â”‚
â”‚ â”‚ [18:30:16] æ­£åœ¨è§£æç§å­æ–‡ä»¶...                   â”‚ â”‚
â”‚ â”‚ [18:30:16] ç§å­æ–‡ä»¶è§£æå®Œæˆ                      â”‚ â”‚
â”‚ â”‚ [18:30:17] æ­£åœ¨åˆ›å»ºä¸‹è½½æ–‡ä»¶...                   â”‚ â”‚
â”‚ â”‚ [18:30:18] ä¸‹è½½æ–‡ä»¶åˆ›å»ºå®Œæˆ                      â”‚ â”‚
â”‚ â”‚ [18:30:18] ç¼“å†²åŒºåˆ›å»ºå®Œæˆ (16MB)                 â”‚ â”‚
â”‚ â”‚ [18:30:19] å¼€å§‹è¿æ¥trackerå’Œpeers...             â”‚ â”‚
â”‚ â”‚ ...                                             â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç»ˆç«¯ç‰ˆæœ¬ï¼ˆncursesï¼‰

```bash
./ttorrent your-file.torrent
```

---

## ğŸ¯ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šä¸‹è½½Ubuntu ISO

```bash
# ä¸‹è½½ç§å­æ–‡ä»¶
wget https://releases.ubuntu.com/22.04/ubuntu-22.04-desktop-amd64.iso.torrent

# å¯åŠ¨GTKç•Œé¢ä¸‹è½½
./ttorrent-gtk ubuntu-22.04-desktop-amd64.iso.torrent
```

### ç¤ºä¾‹2ï¼šåå°è¿è¡Œï¼ˆæ—¥å¿—é‡å®šå‘ï¼‰

```bash
# GTKç‰ˆæœ¬ä¼šæ‰“å¼€çª—å£ï¼Œæ— éœ€é‡å®šå‘
./ttorrent-gtk large-file.torrent

# å¦‚æœéœ€è¦æ•è·æ§åˆ¶å°è¾“å‡º
./ttorrent-gtk large-file.torrent 2>&1 | tee download.log
```

### ç¤ºä¾‹3ï¼šæ–­ç‚¹ç»­ä¼ 

```bash
# ç¬¬ä¸€æ¬¡ä¸‹è½½åˆ°50%æ—¶å…³é—­çª—å£
./ttorrent-gtk test.torrent

# é‡æ–°å¯åŠ¨ï¼Œè‡ªåŠ¨æ¢å¤è¿›åº¦
./ttorrent-gtk test.torrent
```

---

## ğŸ“Š ç•Œé¢å…ƒç´ è¯´æ˜

### è¿›åº¦æ¡
- **ç»¿è‰²å¡«å……éƒ¨åˆ†**ï¼šå·²ä¸‹è½½çš„æ•°æ®
- **ç™¾åˆ†æ¯”æ˜¾ç¤º**ï¼šç²¾ç¡®åˆ°å°æ•°ç‚¹åä¸€ä½
- **è‡ªåŠ¨æ›´æ–°**ï¼šæ¯ç§’åˆ·æ–°ä¸€æ¬¡

### ç»Ÿè®¡ä¿¡æ¯
- **Pieces**ï¼šå·²ä¸‹è½½/æ€»piecesæ•°é‡
- **ä¸‹è½½é€Ÿåº¦**ï¼šå®æ—¶ä¸‹è½½é€Ÿç‡ï¼Œè‡ªåŠ¨å•ä½è½¬æ¢ï¼ˆB/s, KB/s, MB/sï¼‰
- **ä¸Šä¼ é€Ÿåº¦**ï¼šå®æ—¶ä¸Šä¼ é€Ÿç‡
- **å·²ä¸‹è½½**ï¼šç´¯è®¡ä¸‹è½½æ•°æ®é‡
- **è¿æ¥çš„Peers**ï¼šå½“å‰æ´»è·ƒçš„peerè¿æ¥æ•°

### æ—¥å¿—çª—å£
- **æ—¶é—´æˆ³**ï¼šæ¯æ¡æ—¥å¿—å¸¦æ—¶é—´æ ‡è®°
- **è‡ªåŠ¨æ»šåŠ¨**ï¼šæ–°æ—¥å¿—è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
- **å¯æ»šåŠ¨æŸ¥çœ‹**ï¼šæ”¯æŒé¼ æ ‡æ»šè½®å’Œæ»šåŠ¨æ¡

---

## âš™ï¸ é«˜çº§åŠŸèƒ½

### å¤šçº¿ç¨‹æ¶æ„

GTKç‰ˆæœ¬é‡‡ç”¨**åŒçº¿ç¨‹è®¾è®¡**ï¼š

```
ä¸»çº¿ç¨‹ (GTKä¸»å¾ªç¯)
  â”œâ”€ GUIæ¸²æŸ“å’Œäº‹ä»¶å¤„ç†
  â”œâ”€ å®šæ—¶å™¨æ›´æ–°æ˜¾ç¤ºï¼ˆæ¯ç§’ï¼‰
  â””â”€ ç”¨æˆ·äº¤äº’å“åº”

ä¸‹è½½çº¿ç¨‹ (åå°çº¿ç¨‹)
  â”œâ”€ torrentåè®®å¤„ç†
  â”œâ”€ trackeré€šä¿¡
  â”œâ”€ peeræ•°æ®äº¤æ¢
  â””â”€ æ–‡ä»¶I/Oæ“ä½œ
```

### çº¿ç¨‹å®‰å…¨

ä½¿ç”¨`pthread_mutex`ç¡®ä¿ï¼š
- GUIæ›´æ–°æ—¶æ•°æ®ä¸€è‡´æ€§
- æ—¥å¿—å†™å…¥æ— ç«äº‰æ¡ä»¶
- ç»Ÿè®¡æ•°æ®å‡†ç¡®æ€§

---

## ğŸš¨ å¸¸è§é—®é¢˜

### Q1: ç¼–è¯‘æ—¶æç¤ºæ‰¾ä¸åˆ°gtk+-3.0

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# ç¡®è®¤GTK3æ˜¯å¦å®‰è£…
pkg-config --list-all | grep gtk

# å¦‚æœæ²¡æœ‰ï¼Œå®‰è£…GTK3å¼€å‘åŒ…
sudo apt install libgtk-3-dev  # Ubuntu/Debian
```

### Q2: çª—å£æ˜¾ç¤ºä¹±ç 

**åŸå› **ï¼šå­—ä½“æ”¯æŒé—®é¢˜

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# å®‰è£…ä¸­æ–‡å­—ä½“
sudo apt install fonts-noto-cjk

# è®¾ç½®ç¯å¢ƒå˜é‡
export LANG=zh_CN.UTF-8
```

### Q3: çª—å£æ— æ³•æ˜¾ç¤º

**å¯èƒ½åŸå› **ï¼š
1. æ— å›¾å½¢ç¯å¢ƒï¼ˆSSHè¿œç¨‹ï¼‰
2. DISPLAYç¯å¢ƒå˜é‡æœªè®¾ç½®

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥DISPLAY
echo $DISPLAY

# å¦‚æœæ˜¯è¿œç¨‹SSHï¼Œä½¿ç”¨X11è½¬å‘
ssh -X user@server
./ttorrent-gtk test.torrent

# æˆ–ä½¿ç”¨ncursesç‰ˆæœ¬
./ttorrent test.torrent
```

### Q4: å¦‚ä½•å…³é—­ç¨‹åº

- **æ–¹æ³•1**ï¼šç‚¹å‡»çª—å£çš„å…³é—­æŒ‰é’® (âŒ)
- **æ–¹æ³•2**ï¼šåœ¨ç»ˆç«¯æŒ‰ `Ctrl+C`
- **æ–¹æ³•3**ï¼šä½¿ç”¨ç³»ç»Ÿä»»åŠ¡ç®¡ç†å™¨

æ‰€æœ‰æ–¹æ³•éƒ½ä¼šè§¦å‘ï¼š
- ä¿å­˜å½“å‰ä½å›¾ï¼ˆæ–­ç‚¹ç»­ä¼ ï¼‰
- å…³é—­æ‰€æœ‰ç½‘ç»œè¿æ¥
- é‡Šæ”¾å†…å­˜èµ„æº

---

## ğŸ”¬ æŠ€æœ¯ç»†èŠ‚

### GUIæ›´æ–°æœºåˆ¶

```c
// å®šæ—¶å™¨æ¯ç§’è§¦å‘ä¸€æ¬¡
g_timeout_add(1000, update_gui_timeout, NULL);

// æ›´æ–°å‡½æ•°
static gboolean update_gui_timeout(gpointer data) {
    // çº¿ç¨‹å®‰å…¨åŠ é”
    pthread_mutex_lock(&gui_mutex);
    
    // æ›´æ–°æ‰€æœ‰GUIç»„ä»¶
    gtk_progress_bar_set_fraction(...);
    gtk_label_set_text(...);
    
    // è§£é”
    pthread_mutex_unlock(&gui_mutex);
    
    return TRUE; // ç»§ç»­å®šæ—¶å™¨
}
```

### æ—¥å¿—ç³»ç»Ÿ

```c
// ä»ä»»ä½•çº¿ç¨‹æ·»åŠ æ—¥å¿—
void gui_log(const char *message) {
    pthread_mutex_lock(&gui_mutex);
    
    // è·å–æ—¶é—´æˆ³
    char timestamp[64];
    strftime(timestamp, sizeof(timestamp), "[%H:%M:%S] ", tm_info);
    
    // æ’å…¥æ—¥å¿—
    gtk_text_buffer_insert(log_buffer, &iter, timestamp, -1);
    gtk_text_buffer_insert(log_buffer, &iter, message, -1);
    
    // è‡ªåŠ¨æ»šåŠ¨
    gtk_text_view_scroll_to_mark(...);
    
    pthread_mutex_unlock(&gui_mutex);
}
```

---

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | GTKç‰ˆ | ncursesç‰ˆ |
|------|-------|-----------|
| å†…å­˜å ç”¨ | ~5MB | ~1MB |
| CPUå ç”¨(GUI) | ~2% | ~0.5% |
| æ›´æ–°é¢‘ç‡ | 1Hz | 1Hz |
| ç”¨æˆ·ä½“éªŒ | â­â­â­â­â­ | â­â­â­â­ |
| é€‚ç”¨åœºæ™¯ | æ¡Œé¢ç¯å¢ƒ | ç»ˆç«¯/SSH |

---

## ğŸ“ å¼€å‘è€…ä¿¡æ¯

### ç¼–è¯‘é€‰é¡¹è¯´æ˜

```makefile
# GTKç¼–è¯‘æ ‡å¿—
GTK_CFLAGS= `pkg-config --cflags gtk+-3.0`
# å±•å¼€åç±»ä¼¼: -pthread -I/usr/include/gtk-3.0 ...

# GTKé“¾æ¥æ ‡å¿—
GTK_LIBS= `pkg-config --libs gtk+-3.0`
# å±•å¼€åç±»ä¼¼: -lgtk-3 -lgdk-3 -lpangocairo-1.0 ...
```

### ä¾èµ–å…³ç³»

```
ttorrent-gtk
  â”œâ”€ libgtk-3.so (GTK+3æ ¸å¿ƒ)
  â”œâ”€ libgdk-3.so (GDKç»˜å›¾)
  â”œâ”€ libpango-1.0.so (æ–‡å­—æ¸²æŸ“)
  â”œâ”€ libcairo.so (2Då›¾å½¢)
  â”œâ”€ libglib-2.0.so (é€šç”¨å·¥å…·åº“)
  â”œâ”€ libpthread.so (POSIXçº¿ç¨‹)
  â”œâ”€ libssl.so (OpenSSL)
  â””â”€ libcrypto.so (åŠ å¯†åº“)
```

---

## ğŸ“ æ›´æ–°æ—¥å¿—

**v2.0 (2025-12-24)**
- âœ¨ æ–°å¢GTK+3å›¾å½¢ç•Œé¢ç‰ˆæœ¬
- âœ¨ å®ç°å¤šçº¿ç¨‹æ¶æ„
- âœ¨ æ·»åŠ å®æ—¶æ—¥å¿—æ˜¾ç¤º
- âœ¨ æ”¯æŒä¸­æ–‡å­—ç¬¦æ˜¾ç¤º
- ğŸ”§ ä¿ç•™åŸncursesç»ˆç«¯ç‰ˆæœ¬

**v1.0 (2025-12-15)**
- âœ… åŸºç¡€ncursesç»ˆç«¯ç•Œé¢
- âœ… ä¸‹è½½è¿›åº¦æ˜¾ç¤º

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤é—®é¢˜å’Œæ”¹è¿›å»ºè®®ï¼

---

**æœ€åæ›´æ–°**: 2025å¹´12æœˆ24æ—¥
**ä½œè€…**: Gemini AI Assistant
